{"ast":null,"code":"import{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import{Navigate}from\"react-router-dom\";import{useAuthorizeContextHook}from\"../context/hooks/useContextHook\";import{useGlobalRoleContextHook}from\"../context/hooks/useContextHook\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const LoginPage=()=>{const{authorize,authorizeDispatch}=useAuthorizeContextHook();const[username,setUsername]=useState(\"\");const[password,setPassword]=useState(\"\");const[showLoginErrorMessage,setShowLoginErrorMessage]=useState(\"\");useEffect(()=>{const storedToken=localStorage.getItem(\"token\");if(storedToken){authorizeDispatch({type:\"SET_AUTH\",payload:true});}},[authorizeDispatch,authorize]);const handleSubmitLoginForm=async e=>{e.preventDefault();const response=await fetch(\"/api/users/login\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({username,password})});const json=await response.json();if(!response.ok){console.log(\"REPSPONSE NOT OK\",json.error);}else{setUsername(\"\");setPassword(\"\");authorizeDispatch({type:\"SET_AUTH\",payload:true});console.log(\"JSON\",json);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[authorize&&/*#__PURE__*/_jsx(Navigate,{to:\"/manage-assignments\"}),/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),showLoginErrorMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"login-error-msg\",children:\"The username or the password are incorrect.\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>handleSubmitLoginForm(e),children:[/*#__PURE__*/_jsx(\"label\",{children:\"Login:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:e=>setUsername(e.target.value),value:username}),/*#__PURE__*/_jsx(\"label\",{children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",onChange:e=>setPassword(e.target.value),value:password}),/*#__PURE__*/_jsx(\"button\",{children:\"Login\"})]}),\"If you don't have an account yet, please\",\" \",/*#__PURE__*/_jsx(Link,{to:\"/register\",children:\"register\"}),\".\"]})})})]});};export default LoginPage;","map":{"version":3,"names":["useState","useEffect","Link","Navigate","useAuthorizeContextHook","useGlobalRoleContextHook","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoginPage","authorize","authorizeDispatch","username","setUsername","password","setPassword","showLoginErrorMessage","setShowLoginErrorMessage","storedToken","localStorage","getItem","type","payload","handleSubmitLoginForm","e","preventDefault","response","fetch","method","headers","body","JSON","stringify","json","ok","console","log","error","children","to","className","onSubmit","onChange","target","value"],"sources":["C:/Users/chernysn/Documents/GITHUB_COPIES/MERN_school_dashboard/frontend/src/pages/loginPage.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Navigate } from \"react-router-dom\";\r\nimport { useAuthorizeContextHook } from \"../context/hooks/useContextHook\";\r\nimport { useGlobalRoleContextHook } from \"../context/hooks/useContextHook\";\r\n\r\nconst LoginPage = () => {\r\n  const { authorize, authorizeDispatch } = useAuthorizeContextHook();\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [showLoginErrorMessage, setShowLoginErrorMessage] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const storedToken = localStorage.getItem(\"token\");\r\n\r\n    if (storedToken) {\r\n      authorizeDispatch({ type: \"SET_AUTH\", payload: true });\r\n    }\r\n  }, [authorizeDispatch, authorize]);\r\n\r\n  const handleSubmitLoginForm = async (e) => {\r\n    e.preventDefault();\r\n    const response = await fetch(\"/api/users/login\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ username, password }),\r\n    });\r\n    const json = await response.json();\r\n\r\n    if (!response.ok) {\r\n      console.log(\"REPSPONSE NOT OK\", json.error);\r\n    } else {\r\n      setUsername(\"\");\r\n      setPassword(\"\");\r\n      authorizeDispatch({ type: \"SET_AUTH\", payload: true });\r\n      console.log(\"JSON\", json);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {authorize && <Navigate to=\"/manage-assignments\" />}\r\n      <div className=\"container\">\r\n        <div className=\"bg\">\r\n          <div className=\"form\">\r\n            <h2>Login</h2>\r\n            {showLoginErrorMessage && (\r\n              <div className=\"login-error-msg\">\r\n                The username or the password are incorrect.\r\n              </div>\r\n            )}\r\n            <form onSubmit={(e) => handleSubmitLoginForm(e)}>\r\n              <label>Login:</label>\r\n              <input\r\n                type=\"text\"\r\n                onChange={(e) => setUsername(e.target.value)}\r\n                value={username}\r\n              />\r\n              <label>Password:</label>\r\n              <input\r\n                type=\"password\"\r\n                onChange={(e) => setPassword(e.target.value)}\r\n                value={password}\r\n              />\r\n              <button>Login</button>\r\n            </form>\r\n            If you don't have an account yet, please{\" \"}\r\n            <Link to=\"/register\">register</Link>.\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default LoginPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}